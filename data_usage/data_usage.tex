\chapter{Threat Intelligence Uses}
\label{chapter:data_usage}

In the last chapter, I talked about the data characteristic of 
existing threat intelligence products and their limitations. Given
the current status of threat intelligence, another side of the coin is:
how people are actually using the data currently. This question belong 
to the empirical study on data usage, as I listed in the 
introduction chapter.

As one can see, threat intelligence data can be used in a number
of different ways. It can be used forensically during incident response
(i.e., to better understand and attribute a threat after it has gained
access to a network), it can be used reactively to generate alerts
of suspicious activity in a SIEM system. 
(i.e., to raise awareness of a potential threat
that is currently active), or it can be used proactively to block
traffic (and hence block the associated threats). This last category
of action, traditionally called ``blacklisting'', is uniquely
attractive to a defender since, if effective, it can foreclose certain
threats without requiring individualized attention from a human
analyst. Indeed, it is common to see such precise scenarios
highlighted in the marketing materials for virtually all threat
intelligence offerings.

%However, it far from clear if this promise of threat intelligence in
%the abstract is matched by its implementation in practice.
However, despite all the promises, it is far from clear how people 
actually adopt threat intelligence data, especially for proactive
traffic blocking. Proactively blocking traffic based on threat 
intelligence data is a strong action, and as I showed in last chapter,
threat intelligence feeds can be far from comprehensive and may include
significant numbers of false positives. This could cause an organization
to inadvertently block benign Internet sites. Moreover, on a broader 
scale, a mistakenly added IP in a threat intelligence feed can
effectively be denied service from all organizations using that feed
to block traffic. Given this, it is important to understand the extent
to which network administrators are willing to use such third-party data 
to block network traffic.

In this chapter, I will take the first step towards understanding this
question. In particular, this study seeks to better understand the extent 
to which network administrators make use of threat intelligence IP feeds
(more commonly known as IP blacklists) to proactively block network 
traffic and, if they do, which kinds of data sources are they using for 
that purpose.

The principal challenge in pursuing this question is that such
decisions are largely invisible: a network choosing to block IP
address x, is indistinguishable from one that does not, except to the
owner of IP address x.  Moreover, for operational security reasons,
few organizations are willing to publicly document the details of
their network defenses. Thus, there is no crisp mechanism to
determine if a network blocks certain traffic, let alone a means to
determine the data source driving such a decision.

In this chapter, I explore this question via a combination of inference
and careful testing, resulting in three primary contributions.
First, building on prior work designed to detect
censorship~\cite{ensafi2014detecting, pearce2017augur}, I develop,
test and validate an inference technique using the IP ID side-channel to
detect network-layer blacklisting.  Second, by using this technique with 
a carefully chosen set of IP addresses, I am able to attribute
blocking actions to the use of particular blacklists. Finally, I conduct 
a large-scale pilot study covering over {\reflroughnum} U.S. hosts
to explore the diversity in blacklisting behaviors. Together, this work
uncovers the use of {\blacklistnum} popular public IP blacklists among
the hosts I surveyed, and demonstrate relations between these hosts
and their update pattern on blacklists. I further investigate a broader
use of blacklists among the hosts, and discovered over 73K hosts has
shown blacklist related blocking behavior.


\input{data_usage/content/background.tex}
\input{data_usage/content/methodology.tex}
\input{data_usage/content/experiment_design.tex}
%\input{content/requirements.tex}
%\input{content/implementation.tex}
%\input{content/blacklist_selection.tex}
\input{data_usage/content/perfect_blocking.tex}
\input{data_usage/content/latency_analysis.tex}

\input{data_usage/content/partial_blocking.tex}
\input{data_usage/content/large_scale_study.tex}
\input{data_usage/content/consistency_analysis.tex}


%\input{content/discuss.tex}
\input{data_usage/content/conclusion.tex}