\section{Threat Intelligence Uses}
\label{sec:threat_intel_uses}

Threat intelligence data, at a high-level, promises that by compiling up-to-date 
information about known threats (i.e., IP addresses, domain names, file hashes, 
etc.), recipients of the data will be able to better defend their systems from 
future attacks. Therefore, a primary use case of threat intelligence is 
network defense. Intrusion detection systems or firewalls can directly put 
the data in the system and block the corresponding IP or DNS traffic. Popular 
open source projects such as Snort~\cite{snortids}, Zeek~\cite{zeekids} all provide 
these functionalities. Commercial products, including Palo Alto Network
firewall~\cite{paloaltofirewall}, Fortinet firewall~\cite{fortinetfirewall}, 
Cisco firewall~\cite{ciscofirewall} also incorporate threat intelligence data in 
their defense systems. 

Besides directly taking action, threat intelligence can also be used in security
monitoring and post forensic analysis. In these cases, the system raises alarms
when there are matches between network activities and threat intelligence data.
Threat intelligence data usually come with confidence and severity level for each
individual data item. When investigating these alarms, administrators can 
prioritize the investigation based on the severity level. The system that in 
charge of collecting and organization security alarms are called Security 
Information and Event Management system, or SIEM system. Popular SIEM systems
include Splunk~\cite{splunk}, Sumo Logic~\cite{sumologic} and LogRhythm NextGen 
SIEM~\cite{logrhythm} etc.

In academic research, threat intelligence data is usually used as extra source 
data to assist their study, or to evaluate the performance of their systems or
algorithms. For example, Hao~\etal~\cite{hao2016predator} explored using the
characteristic domains during domain registration to detect potential malicious
domains. In the study, the authors use the Spamhaus domain blacklist and URIBL to check 
the accuracy of their prediction. Singh~\etal~\cite{singh2017characterizing} 
studied the characteristic of Tor exit blocking in the wild, and use public and
private threat intelligence sources to see how much of Tor exit IPs are listed
on these sources. These are experimental use cases researchers have explored 
with threat intelligence data. 

One question that has not been investigated is how threat intelligence 
products are actually being used by organizations currently in the industry.
Understanding the real-world use cases gives us ideas about the adoption of threat
intelligence data, which is essential information to know in the threat
intelligence ecosystem. More importantly, the usage of different products offers
us insight into the potential impact they could have on the Internet. As 
discussed in Chapter~\ref{chapter:data_character}, false positives are relatively 
common in threat intelligence feeds. If an organization is using one threat
intelligence IP feed in its firewall for IP-based traffic blocking, and there
is a false positive (a benign IP address) in this feed, then all the users in
that organization will be affected. From another side, if one online host is
added to an IP feed mistakenly, then this host will lose access to all the
organizations that use this feed as a blocking ruleset. Therefore, the actual
usage of the data in industry is a crucial topic that should get more attention
from the security community.

But this problem is also a very challenging problem. The primary challenge 
is that there are many ways people can use these data. It can be directly 
used to block network traffic, or just raise an alarm in their Security
Information and Event Management(SIEM) systems. Some use cases do not even 
have a well-defined behavior that we can quantitatively measure. 
The actions derived from threat intelligence data can also happen at different
network layers. For example, an organization can deny access on network layer; 
it can also deny access on application layer, like HTTP 403 Forbidden. 
This diverse possibility of use cases makes it hard to assess this problem as 
a whole. 

Little work has been done to try and understand how threat
intelligence data is being used on a large scale. The only work that tries to
look at threat intelligence data from this perspective are industrial surveys
-- wherein organizations fill out questionnaires. One such survey conducted by
the Ponemon Institute~\cite{ponemon2018cti}, surveyed 1,200 IT and IT
security practitioners, asking if they use threat intelligence products, and
if they do what tools do they use that utilize the threat intelligence data.
The survey also asked their user experience. SANS Institute did a
similar study~\cite{shackleford2017cyber} where they surveyed 600
participants from a diverse industry background and asked questions about
their threat intelligence usage. These works are limited in terms
of scale, and their results are all at a very high-level. Although they offered
some useful insight, they can not provide us a concrete understanding
of threat intelligence uses on a large scale. My measurement,
which will be discussed in Chapter~\ref{chapter:data_usage},
is the first work that systematically looks at the problem of inferring
threat intelligence uses and explore its implications.
